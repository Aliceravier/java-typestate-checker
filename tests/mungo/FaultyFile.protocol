typestate FileProtocol {

  Init = {
    Status open(): <OK: Open, FOO: end>
  }

  Open = {
    boolean hasNext(): <true: Read>,
    boolean hasNext2(): {},
    void close(): end
  }

  Read = {
    intt read(): <true: Read, false: Close>,
    void close(): end
  }

  Close = {
    void close(): end,
    void close(): Close
  }

}
